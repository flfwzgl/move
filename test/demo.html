<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>move.js demo</title>
	<link rel="stylesheet" href="css/demo.css">
	<script src='../index.js'></script>
	<script src='./bezier.js'></script>
</head>
<body>
	<div id="container">
		<div class="kind" style="height:30px; line-height:30px; text-align:center; color:#666">
			<strong>move.js</strong>, 基于js的过渡动画库, 可用于任何含有数字的css属性过渡 &emsp;&emsp;
		</div>
		<p style="text-align: center; color: #777; font-size: 12px;">
				优先使用 requestAnimationFrame  
				&emsp;
				&emsp;
				<label style="border: 2px dashed #f00; padding: 5px; border-radius: 0px;">
			 		<input type="button" value="全部开始" id="start">
			 	</label>
		</p>
		<div class="kind">
			<div class="start-box">
				<input type="button" value="linear动画" title="linear">
			</div>
			<div class="move-box">
				<div class="moveObj" id="linear-obj" style="background: #6fc"></div>
				匀速动画 <i>move.linear([0, 800], 
				<select>
					<option value="500">500</option>
					<option value="1000" selected>1000</option>
					<option value="2000">2000</option>
					<option value="5000">5000</option>
				</select>
				, v => box.style.left = `${v}px`)</i>
			</div>
		</div>

		<div class="kind">
			<div class="start-box">
				<input type="button" value="ease动画" title="ease">
			</div>
			<div class="move-box">
				<div class="moveObj" id="ease-obj" style="background: #6cf"></div>
				先加速后减速的动画 <i>move.ease([0, 800], 
				<select>
					<option value="500">500</option>
					<option value="1000" selected>1000</option>
					<option value="2000">2000</option>
					<option value="5000">5000</option>
				</select>
				, v => box.style.left = `${v}px`)</i>
			</div>
		</div>

		<div class="kind">
			<div class="start-box">
				<input type="button" value="ease2动画" title="ease2">
			</div>
			<div class="move-box">
				<div class="moveObj" id="ease2-obj" style="background: #6fc"></div>
				ease2动画 <i>move.ease2([0, 800], 
				<select>
					<option value="500">500</option>
					<option value="1000" selected>1000</option>
					<option value="2000">2000</option>
					<option value="5000">5000</option>
				</select>
				, v => box.style.left = `${v}px`)</i>
			</div>
		</div>

		<div class="kind">
			<div class="start-box">
				<input type="button" value="easeOut动画" title="easeOut">
			</div>
			<div class="move-box">
				<div class="moveObj" id="easeOut-obj" style="background: #f70"></div>
				初速度较大, 一直减速 <i>move.easeOut([0, 800], 
				<select>
					<option value="500">500</option>
					<option value="1000" selected>1000</option>
					<option value="2000">2000</option>
					<option value="5000">5000</option>
				</select>
				, v => box.style.left = `${v}px`)</i>
			</div>
		</div>

		<div class="kind">
			<div class="start-box">
				<input type="button" value="elastic动画" title="elastic">
			</div>
			<div class="move-box">
				<div class="moveObj" id="elastic-obj" style="background: #6fc"></div>
				弹性动画 <i>move.elastic([0, 800], 
				<select>
					<option value="500">500</option>
					<option value="1000" selected>1000</option>
					<option value="2000">2000</option>
					<option value="5000">5000</option>
				</select>
				, v => box.style.left = `${v}px`)</i>
			</div>
		</div>

		<div class="kind">
			<div class="start-box">
				<input type="button" value="collision动画" title="collision">
			</div>
			<div class="move-box">
				<div class="moveObj" id="collision-obj" style="background: #6cf"></div>
				碰撞动画 <i>move.collision([0, 800], 
				<select>
					<option value="500">500</option>
					<option value="1000" selected>1000</option>
					<option value="2000">2000</option>
					<option value="5000">5000</option>
				</select>
				, v => box.style.left = `${v}px`)</i>
			</div>
		</div>

		<div class="kind">
			<div class="start-box">
				<input type="button" value="wave动画" title="wave">
			</div>
			<div class="move-box">
				<div class="moveObj" id="wave-obj" style="background: #fc6"></div>
				wave动画 <i>move.wave([0, 800], 
				<select>
					<option value="500">500</option>
					<option value="1000" selected>1000</option>
					<option value="2000">2000</option>
					<option value="5000">5000</option>
				</select>
				, v => box.style.left = `${v}px`)</i>
			</div>
		</div>

		<div class="kind">
			<div class="start-box">
				<input type="button" value="opposite动画" title="opposite">
			</div>
			<div class="move-box">
				<div class="moveObj" id="opposite-obj" style="background: #6fc"></div>
				opposite动画 <i>move.opposite([0, 800], 
				<select>
					<option value="500">500</option>
					<option value="1000" selected>1000</option>
					<option value="2000">2000</option>
					<option value="5000">5000</option>
				</select>
				, v => box.style.left = `${v}px`)</i>
			</div>
		</div>

		<div class="kind">
			<div class="start-box">
				<input type="button" value="bezier动画曲线" title="bezier">
			</div>
			<div class="move-box">
				<div class="moveObj" id="bezier-obj" style="background: #f70"></div>
				bezier动画(自定义) <i>move.bezier([0, 800], 
				<select>
					<option value="500">500</option>
					<option value="1000" selected>1000</option>
					<option value="2000">2000</option>
					<option value="5000">5000</option>
				</select>
				, v => box.style.left = `${v}px`)</i>
			</div>
		</div>

		<div class="common kind">
			<div class="start-box">
				<input type="button" value="计数" title="count">
			</div>
			<div class="move-box">
				<div class="moveObj" style="width:100px; background:#fd0;" ></div>
				<i>move.linear([0, 20], 20000, v => box.innerHTML = v.toFixed(3) )</i>
			</div>
		</div>

		<div class="common kind">
			<div class="start-box">
				<input type="button" value="复杂动画" title="complex">
			</div>
			<div class="move-box">
				<div class="moveObj">hello</div>
				复杂css属性动画, 一切含有数字的css样式的过渡动画均可使用
			</div>
		</div>
	</div>
	
	<p style="text-align:center">
		<a href="https://flfwzgl.github.io/demo">home</a>
		&emsp;
		<a target="_blank" href="https://github.com/flfwzgl/move">fork me on github</a>		
	</p>
	<a style="width:150px; height:150px; position:fixed; top:0; right:0;" href="https://github.com/flfwzgl/move">
		<img src="https://flfwzgl.github.io/resume/img/fork.svg">
	</a>

	<script>
		function id(ID){
			return document.getElementById(ID);
		}

		function next(obj){
			return obj.nextSibling.nodeType === 1 ? obj.nextSibling : obj.nextSibling.nextSibling;
		}

		function prev(obj){
			return obj.previousSibling.nodeType === 1 ? obj.previousSibling : obj.previousSibling.nexgSibling;
		}

		id("start").onclick = function(){
			doMove(id('linear-obj'), 'linear');
			doMove(id('ease-obj'), 'ease');
			doMove(id('ease2-obj'), 'ease2');
			doMove(id('easeOut-obj'), 'easeOut');
			doMove(id('elastic-obj'), 'elastic');
			doMove(id('collision-obj'), 'collision');
			doMove(id('wave-obj'), 'wave');
			doMove(id('opposite-obj'), 'opposite');
			doMove(id('bezier-obj'), 'bezier');
		}

		function getSelected(obj){
			var obj = obj.parentNode.parentNode.getElementsByTagName('select')[0];
			return +obj.options[obj.selectedIndex].value;
		}


		move.extend({
			bezier: getBezierCurve([1, 0], [.5, 1])
		})


		document.onclick = function(e){
			e = e||event;
			e = e.target;
			if(!e.title) return;
			var temp = next(e.parentNode).getElementsByTagName('div')[0];
			switch(e.title){
				case 'linear':
				case 'ease':
				case 'easeOut':
				case 'elastic':
				case 'collision':
				case 'wave':
				case 'opposite':
				case 'ease2':
				case 'bezier':
					doMove(temp, e.title);
					break;
				case 'count':
					if(!e.counting){
						e.counting = true;
						if(temp.counting) return;
						temp.innerHTML = '';
						e.value = '暂停';
						e.stop = move.linear([e.last || 0, 20], 20000, function(v){
							temp.innerHTML = v.toFixed(3);
						});
					} else {
						e.counting = false;
						e.last = e.stop();
						e.value = '开始';
					}
					break;
				case 'complex':
					if(temp.running) return;
					temp.style.cssText = '';
					temp.running = move.ease([0, 800], 500, function(v){
						temp.style.left = v + 'px';
					}, function(){
						move.collision([0, 1], 1000, function(v){
							temp.style.webkitTransform = "rotateZ("+ 360*v +"deg)";
							temp.style.mozTransform = "rotateZ("+ 360*v +"deg)";
							temp.style.transform = "rotateZ("+ 360*v +"deg)";
						}, function(){
							var l = temp.offsetLeft;
							var t = temp.offsetTop;
							var w = temp.offsetWidth;
							var h = temp.offsetHeight;
							move.ease([0, 1], 1000, function(v){
								temp.style.cssText = ['left:', l + -200*v, 'px;', 
																			'top:', t + -200*v, 'px;',
																			'width:', w + 50*v, 'px;',
																			'height:', h + 50*v, 'px;',
																			'border-radius:', 80*v, 'px;',
																			'border:', 20*v, 'px dashed #555;'].join('');
							}, function(){
								move.ease([0, 1], 2000, function(v){
									temp.style.background = "hsl(" + Math.floor(50 + v*150) + ", 100%, 50%)";
								}, function(){
									move.ease([0, 1], 500, function(v){
										temp.style.boxShadow = v*20 + 'px '+ v*20 +'px '+ v*40 +'px rgba(50, 50, 50, 0.6)';
									}, function(){
										move.ease([1, 0], 500, function(v){
											temp.style.background = 'rgba(0, 170, 255, '+ v +')'
										}, function(){
											move.ease([0, 1], 500, function(v){
												temp.style.fontSize = 16 + v*20 + 'px';
												temp.style.lineHeight = 50 + v*50 + 'px';
											}, function(){
												move.ease([1, 0], 3000, function(v){
													temp.style.opacity = v;
												}, function(){
													temp.style.display = 'none';
													temp.running = false;
												});
											});
										});
									});
								});
							});
						});
					});
			}
		}


		function doMove(obj, type){
			var t = +getSelected(obj);
			move[type]([0, 800], t, function(v){
				obj.style.left = v + 'px';
			});
		}
	</script>
</body>
</html>
